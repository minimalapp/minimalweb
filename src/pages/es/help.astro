---
import BaseLayout from '@/layouts/BaseLayout.astro';
import Header from '@/components/Header.astro';
import Footer from '@/components/Footer.astro';
import PageHero from '@/components/PageHero.astro';
import ContentSection from '@/components/ContentSection.astro';
import SectionTitle from '@/components/SectionTitle.astro';
import CodeBlock from '@/components/CodeBlock.astro';
import CTASection from '@/components/CTASection.astro';
import Button from '@/components/Button.astro';
import StepSection from '@/components/StepSection.astro';
import CategoryCard from '@/components/CategoryCard.astro';
import MetricBox from '@/components/MetricBox.astro';
import InfoBox from '@/components/InfoBox.astro';
import ListCard from '@/components/ListCard.astro';
import FeatureCard from '@/components/FeatureCard.astro';

const locale = 'es';

const gettingStartedSteps = [
  {
    number: 1,
    title: "Crea tu Cuenta",
    description: "Regístrate en minimal.lat con tu correo electrónico. Tendrás acceso al panel de control donde podrás administrar todos tus sitios.",
    content: ''
  },
  {
    number: 2,
    title: "Agrega tu Sitio Web",
    description: "Haz clic en \"Agregar Nuevo Sitio\" en tu panel, ingresa la URL de tu sitio web y recibirás un ID de Sitio único. Este ID conecta Minimal con tu sitio web.",
    content: ''
  },
  {
    number: 3,
    title: "Instala el Script",
    description: "Copia el script proporcionado y pégalo antes de la etiqueta de cierre </body> en tu sitio web. El widget aparecerá automáticamente.",
    content: '<div class="bg-[#0F1419] text-[var(--brand-green)] p-6 rounded-lg font-mono text-sm overflow-x-auto"><code>&lt;script src="https://minimal.lat/embed.js" data-site-id="your-site-id"&gt;&lt;/script&gt;</code></div>'
  },
  {
    number: 4,
    title: "Personaliza y Lanza",
    description: "Desde tu panel, personaliza colores, posición, mensajes de bienvenida y más. ¡Los cambios se aplican instantáneamente – sin necesidad de actualizar tu código!",
    content: ''
  }
];

---

<BaseLayout title="Centro de Ayuda - Minimal" description="Obtén ayuda y encuentra respuestas a preguntas frecuentes." locale={locale}>
  <Header locale={locale} />

  <main class="pt-header">
    <PageHero
      title="Centro de Ayuda"
      subtitle="Obtén ayuda y encuentra respuestas a preguntas frecuentes sobre Minimal."
    />

    <!-- Help Categories -->
    <ContentSection>
      <SectionTitle title="Explorar por Categoría" centered={true} />
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 lg:gap-8">
        <CategoryCard
          href="#getting-started"
          icon="rocket"
          title="Primeros Pasos"
          description="Aprende lo básico y configura Minimal"
        />
        <CategoryCard
          href="#integration"
          icon="puzzle-piece"
          title="Guía de Integración"
          description="Instrucciones de configuración por plataforma"
        />
        <CategoryCard
          href="#customization"
          icon="paint-brush"
          title="Personalización"
          description="Personaliza apariencia y comportamiento"
        />
        <CategoryCard
          href="#analytics"
          icon="chart-bar"
          title="Análisis"
          description="Comprende tus métricas"
        />
        <CategoryCard
          href="#best-practices"
          icon="pencil-square"
          title="Mejores Prácticas"
          description="Escribir conversaciones efectivas"
        />
        <CategoryCard
          href="#conversation-design"
          icon="chat-bubble-left-right"
          title="Diseño de Conversación"
          description="Diseña flujos naturales"
        />
        <CategoryCard
          href="#troubleshooting"
          icon="wrench"
          title="Solución de Problemas"
          description="Problemas comunes y soluciones"
        />
        <CategoryCard
          href="#api"
          icon="code"
          title="Referencia de API"
          description="Documentación para desarrolladores"
          comingSoon={true}
        />
      </div>
    </ContentSection>

    <!-- Getting Started -->
    <ContentSection id="getting-started" background="secondary" className="scroll-mt-32">
      <SectionTitle title="Primeros Pasos con Minimal" />
      <StepSection steps={gettingStartedSteps} />
    </ContentSection>

    <!-- Integration Guide -->
    <ContentSection id="integration" className="scroll-mt-32">
      <div class="max-w-4xl mx-auto">
        <SectionTitle title="Guía de Integración" centered={true} />
        <p class="text-center text-xl text-[var(--text-secondary)] mb-8 max-w-4xl mx-auto leading-relaxed">Elige tu plataforma y sigue las instrucciones de instalación. ¿Necesitas ayuda? Consulta nuestra <a href="/es/integration" class="text-[var(--brand-green)] hover:underline">página de integración detallada</a>.</p>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <InfoBox
            icon="code"
            title="Plataformas Web"
            description="Instala Minimal en cualquier sitio web con una simple etiqueta de script de una línea. Funciona con HTML, JavaScript y todos los frameworks modernos incluyendo React, Vue, Angular y Next.js."
            variant="tertiary"
          />

          <InfoBox
            icon="shopping-cart"
            title="E-commerce & CMS"
            description="Integraciones nativas para plataformas populares con fácil configuración desde el panel."
            items={[
              'WordPress - Plugin del repositorio',
              'Webflow - Integración de código personalizado',
              'Framer - Componente de código personalizado',
              'Wix - Integración de código personalizado',
              'Squarespace - Inyección de código'
            ]}
            variant="tertiary"
            comingSoon={true}
          />
        </div>
      </div>
    </ContentSection>

    <!-- Dashboard Customization -->
    <ContentSection id="customization" background="secondary" className="scroll-mt-32">
      <div class="max-w-4xl mx-auto">
        <SectionTitle title="Personalización del Panel" centered={true} />
        <p class="text-center text-xl text-[var(--text-secondary)] mb-8 max-w-4xl mx-auto leading-relaxed">Personaliza la apariencia de tu widget directamente desde el panel de Minimal - sin necesidad de código.</p>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <InfoBox
            icon="cursor-arrow-rays"
            title="Botón de Chat"
            description="Controla dónde y cómo aparece el botón de chat en tu sitio web."
            items={[
              'Posición del Botón: Abajo Derecha, Abajo Izquierda, Arriba Derecha, Arriba Izquierda',
              'Color del Botón: Elige cualquier color para coincidir con tu marca'
            ]}
            variant="tertiary"
          />

          <InfoBox
            icon="paint-brush"
            title="Colores de Marca"
            description="Haz que el widget se sienta como parte nativa de tu sitio web."
            items={[
              'Color Primario: Color principal de marca para acentos y resaltados',
              'Color Secundario: Color secundario de marca para estilos adicionales'
            ]}
            variant="tertiary"
          />

          <InfoBox
            icon="cog"
            title="Características"
            description="Activa o desactiva características para personalizar la experiencia del usuario."
            items={[
              'Frases de Bienvenida: Muestra mensajes de bienvenida rotativos antes de que el usuario comience a chatear'
            ]}
            variant="tertiary"
          />

          <InfoBox
            icon="sparkles"
            title="Fácil de Usar"
            description="Todas las opciones de personalización están disponibles en tu panel bajo Configuración del Widget. Los cambios se aplican instantáneamente - no necesitas actualizar ningún código en tu sitio web."
            variant="tertiary"
          />
        </div>
      </div>
    </ContentSection>

    <!-- Advanced Script Customization -->
    <ContentSection id="advanced-customization" className="scroll-mt-32">
      <div class="max-w-4xl mx-auto">
        <SectionTitle title="Personalización Avanzada de Script" centered={true} />
        <p class="text-center text-xl text-[var(--text-secondary)] mb-8 max-w-4xl mx-auto leading-relaxed">Para desarrolladores que necesitan más control, las opciones de configuración avanzada de script estarán disponibles pronto.</p>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <InfoBox
            icon="code"
            title="Atributos de Datos"
            description="Personaliza Minimal directamente en la etiqueta de script usando atributos de datos para posición, tema, idioma y más."
            variant="tertiary"
            comingSoon={true}
          />

          <InfoBox
            icon="command-line"
            title="API de JavaScript"
            description="Control programático completo con objetos de configuración de JavaScript para casos de uso avanzados."
            variant="tertiary"
            comingSoon={true}
          />
        </div>
      </div>
    </ContentSection>

    <!-- Analytics -->
    <ContentSection id="analytics" background="secondary" className="scroll-mt-32">
      <div class="max-w-5xl mx-auto">
        <SectionTitle title="Comprende tus Análisis" centered={true} />
        <p class="text-center text-xl text-[var(--text-secondary)] mb-8 max-w-4xl mx-auto leading-relaxed">Obtén información sobre cómo los visitantes interactúan con tu interfaz conversacional.</p>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <InfoBox
            icon="chart-bar"
            title="Métricas Clave"
            description="Rastrea tus métricas de conversación más importantes de un vistazo:"
            items={[
              'Total de Conversaciones: Número de chats en los últimos 30 días',
              'Conversaciones Activas: Chats actualmente en curso',
              'Total de Mensajes: Todos los mensajes intercambiados',
              'Promedio de Mensajes por Conversación: Indicador de profundidad'
            ]}
            variant="tertiary"
          />

          <InfoBox
            icon="arrow-trending-up"
            title="Conversaciones en el Tiempo"
            description="Visualiza tendencias de conversación con un gráfico de línea interactivo que muestra el volumen diario de conversaciones del último mes."
            variant="tertiary"
          />

          <InfoBox
            icon="chart-pie"
            title="Distribución de Estados"
            description="Ve cómo terminan tus conversaciones con un desglose de:"
            items={[
              'Completadas: Conversaciones finalizadas exitosamente',
              'Activas: Conversaciones en curso',
              'Abandonadas: Conversaciones dejadas sin resolución'
            ]}
            variant="tertiary"
          />

          <InfoBox
            icon="face-smile"
            title="Análisis de Sentimiento"
            description="Comprende la satisfacción del usuario a través de detección automática de sentimiento:"
            items={[
              'Positivo: Interacciones felices y satisfechas',
              'Neutral: Intercambios informativos',
              'Negativo: Usuarios frustrados o insatisfechos'
            ]}
            variant="tertiary"
          />

          <InfoBox
            icon="sparkles"
            title="Tendencia de Engagement"
            description="Monitorea tu Puntuación Promedio de Engagement a lo largo del tiempo para ver qué tan bien tu IA se conecta con los visitantes."
            variant="tertiary"
          />

          <InfoBox
            icon="light-bulb"
            title="Top Intenciones y Uso de Tokens"
            description="Descubre qué preguntan más los usuarios y rastrea tu consumo de tokens para gestionar el uso efectivamente."
            variant="tertiary"
          />
        </div>
      </div>
    </ContentSection>

    <!-- Best Practices -->
    <ContentSection id="best-practices" className="scroll-mt-32">
      <div class="max-w-4xl mx-auto">
        <SectionTitle title="Escribir Conversaciones Efectivas" centered={true} />
        <p class="text-center text-xl text-[var(--text-secondary)] mb-8 max-w-4xl mx-auto leading-relaxed">Crea mensajes que enganchen a los usuarios e impulsen las conversiones.</p>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <ListCard
            title="Mejores Prácticas"
            items={[
              'Mantén los saludos cálidos y conversacionales, no corporativos',
              'Haz preguntas abiertas para entender las necesidades del usuario',
              'Proporciona respuestas rápidas para preguntas comunes',
              'Usa la voz y personalidad de tu marca',
              'Establece expectativas sobre tiempos de respuesta'
            ]}
            bulletType="checkmark"
          />

          <ListCard
            title="Qué Evitar"
            items={[
              'Saludos genéricos como "Hola" o "Bienvenido"',
              'Lenguaje excesivamente formal o robótico',
              'Pedir información que ya tienes',
              'Demasiados mensajes a la vez (abrumar usuarios)',
              'Llamadas a la acción poco claras'
            ]}
            bulletType="x"
          />
        </div>
      </div>
    </ContentSection>

    <!-- Conversation Design -->
    <ContentSection id="conversation-design" background="secondary" className="scroll-mt-32">
      <div class="max-w-4xl mx-auto">
        <SectionTitle title="Diseño de Conversación" centered={true} />
        <p class="text-center text-xl text-[var(--text-secondary)] mb-8 max-w-4xl mx-auto leading-relaxed">Diseña flujos de conversación que se sientan naturales y guíen a los usuarios a sus objetivos.</p>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <FeatureCard
            icon="chat-bubble-left-right"
            title="Flujo Natural"
            description="Mantén las conversaciones con un tono humano y útil. Usa mensajes cortos, haz una pregunta a la vez y reconoce las respuestas del usuario antes de avanzar."
          />
          <FeatureCard
            icon="arrow-path"
            title="Respuestas Rápidas"
            description="Ofrece respuestas sugeridas para preguntas comunes. Esto acelera las interacciones y ayuda a usuarios que no están seguros de qué preguntar."
          />
          <FeatureCard
            icon="light-bulb"
            title="Enrutamiento Inteligente"
            description="Guía a los usuarios a la información correcta basándote en sus preguntas. Usa el contexto de mensajes anteriores para proporcionar seguimientos relevantes."
          />
          <FeatureCard
            icon="check-circle"
            title="CTAs Claros"
            description="Cada conversación debe tener un propósito. Facilita que los usuarios den el siguiente paso con sugerencias claras y accionables."
          />
        </div>
      </div>
    </ContentSection>

    <!-- Troubleshooting -->
    <ContentSection id="troubleshooting" className="scroll-mt-32">
      <div class="max-w-4xl mx-auto">
        <SectionTitle title="Solución de Problemas" centered={true} />
        <p class="text-center text-xl text-[var(--text-secondary)] mb-8 max-w-4xl mx-auto leading-relaxed">Problemas comunes y cómo resolverlos.</p>

        <div class="space-y-6">
          <div class="bg-[var(--bg-primary)] border border-[var(--border-primary)] rounded-md p-6">
            <h3 class="text-xl text-[var(--text-primary)] font-semibold mb-3">El Widget No Aparece</h3>
            <p class="text-[var(--text-secondary)] mb-3">Si el widget no se muestra en tu sitio:</p>
            <ul class="list-disc pl-6 space-y-2 text-[var(--text-secondary)]">
              <li>Verifica que el script esté colocado antes de la etiqueta de cierre <code class="bg-[var(--bg-tertiary)] text-[var(--brand-green)] px-2 py-1 rounded text-sm">&lt;/body&gt;</code></li>
              <li>Verifica que tu ID de Sitio sea correcto en el panel de control</li>
              <li>Asegúrate de que JavaScript esté habilitado en tu navegador</li>
              <li>Limpia la caché de tu navegador y recarga forzadamente (Ctrl+Shift+R o Cmd+Shift+R)</li>
              <li>Revisa la consola del navegador en busca de mensajes de error</li>
            </ul>
          </div>

          <div class="bg-[var(--bg-primary)] border border-[var(--border-primary)] rounded-md p-6">
            <h3 class="text-xl text-[var(--text-primary)] font-semibold mb-3">Problemas de Posición del Widget</h3>
            <p class="text-[var(--text-secondary)] mb-3">Si el widget aparece en la posición incorrecta o se superpone con otros elementos:</p>
            <ul class="list-disc pl-6 space-y-2 text-[var(--text-secondary)]">
              <li>Ajusta la configuración de posición en tu panel (bottom-right, bottom-left, etc.)</li>
              <li>Verifica conflictos de CSS con valores altos de z-index en tu sitio</li>
              <li>Usa CSS personalizado para anular el posicionamiento si es necesario</li>
              <li>Prueba diferentes valores de desplazamiento para evitar superposiciones con otros elementos fijos</li>
            </ul>
          </div>

          <div class="bg-[var(--bg-primary)] border border-[var(--border-primary)] rounded-md p-6">
            <h3 class="text-xl text-[var(--text-primary)] font-semibold mb-3">Las Conversaciones No Se Guardan</h3>
            <p class="text-[var(--text-secondary)] mb-3">Si las conversaciones no aparecen en tu panel:</p>
            <ul class="list-disc pl-6 space-y-2 text-[var(--text-secondary)]">
              <li>Verifica que hayas iniciado sesión en la cuenta correcta</li>
              <li>Verifica que estés viendo el sitio correcto en el panel</li>
              <li>Asegúrate de que tu plan no haya alcanzado los límites de conversaciones</li>
              <li>Permite unos minutos para la sincronización de datos</li>
              <li>Contacta al soporte si el problema persiste después de 15 minutos</li>
            </ul>
          </div>

          <div class="bg-[var(--bg-primary)] border border-[var(--border-primary)] rounded-md p-6">
            <h3 class="text-xl text-[var(--text-primary)] font-semibold mb-3">Los Estilos No Se Aplican</h3>
            <p class="text-[var(--text-secondary)] mb-3">Si los colores o estilos personalizados no se muestran:</p>
            <ul class="list-disc pl-6 space-y-2 text-[var(--text-secondary)]">
              <li>Los cambios en el panel se aplican instantáneamente - no se necesitan actualizaciones de código</li>
              <li>Limpia la caché del navegador para ver los últimos cambios de estilo</li>
              <li>Verifica que CSS personalizado no esté anulando tu configuración</li>
              <li>Verifica que los valores de color estén en formato hexadecimal válido (ej., #10b981)</li>
            </ul>
          </div>
        </div>
      </div>
    </ContentSection>

    <!-- API Reference -->
    <ContentSection id="api" className="scroll-mt-32">
      <div class="max-w-4xl mx-auto">
        <h2 class="text-4xl md:text-5xl font-bold text-[var(--text-primary)] text-center mb-6">
          Referencia de API <span class="coming-soon-badge-inline align-middle">Coming soon</span>
        </h2>
        <p class="text-center text-xl text-[var(--text-secondary)] mb-8 max-w-4xl mx-auto leading-relaxed">API de JavaScript para control y personalización avanzados.</p>

        <h3 class="text-2xl text-[var(--text-primary)] font-semibold mb-4">Métodos de Control del Widget</h3>
        <div class="bg-[var(--bg-tertiary)] border border-[var(--border-primary)] rounded-md p-6 mb-6">
          <CodeBlock code={`// Abrir el widget
Minimal.open();

// Cerrar el widget
Minimal.close();

// Alternar estado del widget
Minimal.toggle();

// Verificar si el widget está abierto
const isOpen = Minimal.isOpen(); // devuelve booleano

// Destruir la instancia del widget
Minimal.destroy();`} />
        </div>

        <h3 class="text-2xl text-[var(--text-primary)] font-semibold mb-4 mt-8">Seguimiento de Eventos</h3>
        <div class="bg-[var(--bg-tertiary)] border border-[var(--border-primary)] rounded-md p-6 mb-6">
          <CodeBlock code={`// Rastrear eventos personalizados
Minimal.trackEvent('event_name', {
  customData: 'value',
  userId: '12345'
});

// Establecer contexto de usuario
Minimal.setContext({
  userId: 'user_123',
  email: 'user@example.com',
  plan: 'premium'
});

// Identificar usuario
Minimal.identify({
  userId: 'user_123',
  name: 'John Doe',
  email: 'john@example.com'
});`} />
        </div>

        <h3 class="text-2xl text-[var(--text-primary)] font-semibold mb-4 mt-8">Escuchadores de Eventos</h3>
        <div class="bg-[var(--bg-tertiary)] border border-[var(--border-primary)] rounded-md p-6 mb-6">
          <CodeBlock code={`// Escuchar eventos del widget
window.addEventListener('minimal:open', () => {
  console.log('Widget abierto');
});

window.addEventListener('minimal:close', () => {
  console.log('Widget cerrado');
});

window.addEventListener('minimal:message', (event) => {
  console.log('Mensaje enviado:', event.detail);
});

window.addEventListener('minimal:ready', () => {
  console.log('Widget inicializado');
});`} />
        </div>

        <h3 class="text-2xl text-[var(--text-primary)] font-semibold mb-4 mt-8">Actualizaciones de Configuración</h3>
        <div class="bg-[var(--bg-tertiary)] border border-[var(--border-primary)] rounded-md p-6">
          <CodeBlock code={`// Actualizar configuración en tiempo de ejecución
Minimal.updateConfig({
  theme: 'dark',
  position: 'bottom-left',
  greeting: 'Nuevo mensaje de bienvenida'
});

// Obtener configuración actual
const config = Minimal.getConfig();`} />
        </div>
      </div>
    </ContentSection>

    <!-- Need More Help -->
    <CTASection
      title="¿Necesitas Más Ayuda?"
      description="¿No encuentras lo que buscas? Nuestro equipo de soporte está aquí para ayudar."
      background="secondary"
    >
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <Button variant="primary" size="lg" href="/es/contact">
          Contactar Soporte
        </Button>
      </div>
    </CTASection>
  </main>

  <Footer locale={locale} />
</BaseLayout>
